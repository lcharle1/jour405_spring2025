---
title: " final_project "
output: html_notebook
 b---
 
New concept/Update: As I researched more data and tried to incorporate race and ethnicity into the data, I found decade-long occupational earning differences between men and women. It sparked a story idea of the earning difference between men and women in dominated fields. Website link: https://www.census.gov/data/tables/time-series/demo/industry-occupation/median-earnings.html? . I used ChatGPT to try to find sources with data on men's and women's earnings, annually, for different races and ethnicities, and in various occupations. 

The story is that women are still earning less than men even in women-dominated fields. Three women-dominated fields are: General and operations managers, Elementary and middle school teachers, and Registered nurses. 

I randomly chose women-dominated fields from this website: https://www.dol.gov/agencies/wb/data/occupations/most-common-occupations-women-labor-force, provided by the U.S. Department of Labor's Women's Bureau. 

My null and alternative hypotheses remain the same: 
-Null hypothesis: There is no difference in the average earnings between men and women

- Alternate hypothesis: There is a difference in the average earnings between men and women. 

Here is the ChatGPT link. I used it because I had to remove a row that had N/A in it and to find which way would be best to display the occupation and earning differences. I forgot to remove it before converting to CSV. 
https://chatgpt.com/share/680e7c79-55e8-8003-b021-3f2a3150f277



Previous update: Using table A-7 from a pdf, https://www2.census.gov/library/publications/2024/demo/p60-282.pdf ,produced by the US Census Bureau about the number and real median earnings of total workers and full-time, year-round workers with earnings by sex, from 1960 to 2023. I narrowed down my research to total workers and 2000 to 2023 because the prior to 2000 the data has N/A's. Information on sampling error, non sampling error, and definitions is available at <https://www2.census.gov/programs-surveys/cps/techdocs/cpsmar24.pdf. 


Compared to the other source I found, this does not mention the race/ethnicity of the workers. But I altered by null and alternate hypothesis to match the data. 

Null hypothesis: There is no difference in the average earnings between men and women

Alternate hypothesis: There is a difference in the average earnings between men and women. 

I replicated the work we did in HW 9 (testscores) to perform the t-test and show a linegraph showing the difference in earnings between men and women in the last 23 years. 

```{r}
# library
library(tidyverse)

library(janitor)

library(readr)

library(dplyr)

library(ggplot2)


```

```{r}
#Earning dataset showcasing the earnings between men and women over the last 10 years.  
earning_data <- read_csv("project/Final Project Earnings from Different Occupations for Men and Women 2023-2013  - Copy of Sheet1.csv")

#clean the dataset
earning_data <- earning_data %>%
  clean_names()

#I found a row I forgot to remove that has no data, it just had N/A in it.
cleaned_earning_data <- earning_data %>%
  drop_na()

view(cleaned_earning_data)

```


```{r}

# Set the significance level
alpha_level <- 0.05

t_test_result <- t.test(earnings ~ sex, data = cleaned_earning_data)


#view t-test
view(t_test_results)

  
```


```{r}
# Get the p-value
p_value <- t_test_result$p.value

# Get the 95% confidence interval
ci <- t_test_result$conf.int

# Compute group stats
group_stats <- earning_data |>
  group_by(Sex) |>
  summarize(avg_earnings = mean(Earnings, na.rm = TRUE))

# Extract group means
mean_male <- group_stats |> filter(Sex == "Male") |> pull(avg_earnings)
mean_female <- group_stats |> filter(Sex == "Female") |> pull(avg_earnings)

# Build a summary tibble for your story
story_stats <- tibble(
  `Male average` = mean_male,
  `Female average` = mean_female,
  `Difference` = mean_male - mean_female,
  `Percent difference` = round(((mean_male - mean_female) / mean_female) * 100, 1),
  `p-value` = sprintf("%.4f", p_value),
  `Lower bound (95% CI)` = round(ci[1], 2),
  `Upper bound (95% CI)` = round(ci[2], 2),
  `Confidence level` = "95%"
)

# Show the summary
story_stats

```



```{r}
# Get the p-value
p_value <- t_test_result$p.value

# Get the 95% confidence interval
ci <- t_test_result$conf.int

# Compute group stats
group_stats <- cleaned_earning_data %>%
  group_by(sex) %>%
  summarize(avg_earnings = mean(earnings, na.rm = TRUE), .groups = "drop")

# Extract group means
mean_male <- group_stats %>% filter(sex == "Men") %>% pull(avg_earnings)
mean_female <- group_stats %>% filter(sex == "Women") %>% pull(avg_earnings)

# Build a summary tibble for your story
story_stats <- tibble(
  `Male average` = mean_male,
  `Female average` = mean_female,
  `Difference` = mean_male - mean_female,
  `Percent difference` = round(((mean_male - mean_female) / mean_female) * 100, 1),
  `p-value` = sprintf("%.4f", p_value),
  `Lower bound (95% CI)` = round(ci[1], 2),
  `Upper bound (95% CI)` = round(ci[2], 2),
  `Confidence level` = "95%"
)

# Show the summary
glimpse(story_stats)
```

According to the story_stats, we can reject the null hypothesis because 0.02 < 0.05. There is no difference in the average earnings between men and women. 

Below are three graphs, one for each occupation showing the variations of earning differences between men and women over the last decade, except 2020. 

```{r}

##Registered Nurse Graph 

# Filter data for Registered Nurses
nurse_data <- cleaned_earning_data %>%
  filter(occupation == "Registered nurses")

# Plot
ggplot(nurse_data, aes(x = year, y = earnings, fill = sex)) +
  geom_col(position = "dodge") +
  labs(
    title = "Earnings of Registered Nurses (2013–2023)",
    x = "Year",
    y = "Median Earnings (USD)",
    fill = "Sex"
  ) +
  theme_minimal() +
  scale_fill_manual(values = c("Men" = "Blue", "Women" = "Red")) +
  theme(
    plot.title = element_text(face = "bold", size = 14),
    axis.title = element_text(face = "bold"),
    legend.position = "top"
  )
```
Description: 2013 and 2014, there is a decrease in both earnings. In 2015 there is a spike for women and they surpass men's earnings, but decrease below men the following year. In 2018 the earnings increase significantly and continue to increase the rest of the years. Men increase more than women. 



```{r}
##Elementary and middle school teachers Graph 

# Filter data for Elementary and middle school teachers
teacher_data <- cleaned_earning_data %>%
  filter(occupation == "Elementary and middle school teachers")

# Plot
ggplot(teacher_data, aes(x = year, y = earnings, fill = sex)) +
  geom_col(position = "dodge") +
  labs(
    title = "Earnings of Elementary and middle school teachers (2013–2023)",
    x = "Year",
    y = "Median Earnings (USD)",
    fill = "Sex"
  ) +
  theme_minimal() +
  scale_fill_manual(values = c("Men" = "Blue", "Women" = "Red")) +
  theme(
    plot.title = element_text(face = "bold", size = 14),
    axis.title = element_text(face = "bold"),
    legend.position = "top"
  )
  
```
Description: Throughout the entire decade men surpass women. In 2015 the earnings for men begin to decrease, while women is slowly rising. In 2017 there is a close earning amount but the following year women decrease and men begin to increase. After 2020, they are both increase, but there is an earning gap. 


```{r}

##General and operations managers Graph 

# Filter data for General and operations managers
manager_data <- cleaned_earning_data %>%
  filter(occupation == "General and operations managers")

# Plot
ggplot(manager_data, aes(x = year, y = earnings, fill = sex)) +
  geom_col(position = "dodge") +
  labs(
    title = "Earnings of General and operations managers (2013–2023)",
    x = "Year",
    y = "Median Earnings (USD)",
    fill = "Sex"
  ) +
  theme_minimal() +
  scale_fill_manual(values = c("Men" = "Blue", "Women" = "Red")) +
  theme(
    plot.title = element_text(face = "bold", size = 14),
    axis.title = element_text(face = "bold"),
    legend.position = "top"
  )
  

```
Description: There is a decrease from 2013 to 2014 for men and women. From 2014 to 2018, there is a back and forth increase for women's earnings. During that time men gradually increase. 2019 to 2023, except 2020, there is a gradual increase for men and women. There is a significant earning gap between men and women nonetheless. 

